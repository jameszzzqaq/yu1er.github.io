<!doctype html><html lang=en dir=auto>
<head><meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=robots content="index, follow">
<title>yuler's blog</title>
<meta name=keywords content="Blog,Portfolio,PaperMod,Yuler">
<meta name=description content="yuler's blog">
<meta name=author content="yuler">
<link rel=canonical href=https://zhangyh.me/>
<meta name=google-site-verification content="XYZabc">
<meta name=yandex-verification content="XYZabc">
<meta name=msvalidate.01 content="XYZabc">
<link crossorigin=anonymous href=/assets/css/stylesheet.min.css rel="preload stylesheet" as=style>
<link rel=icon href=https://zhangyh.me/icon/jiaran16.ico>
<link rel=icon type=image/png sizes=16x16 href=https://zhangyh.me/icon/jiaran16.ico>
<link rel=icon type=image/png sizes=32x32 href=https://zhangyh.me/icon/jiaran32.ico>
<link rel=apple-touch-icon href=https://zhangyh.me/%3Clink%20/%20abs%20url%3E>
<link rel=mask-icon href=https://zhangyh.me/%3Clink%20/%20abs%20url%3E>
<meta name=theme-color content="#2e2e33">
<meta name=msapplication-TileColor content="#2e2e33">
<meta name=generator content="Hugo 0.88.1">
<link rel=alternate type=application/rss+xml href=https://zhangyh.me/index.xml>
<link rel=alternate type=application/json href=https://zhangyh.me/index.json>
<noscript>
<style>#theme-toggle,.top-link{display:none}</style>
<style>@media(prefers-color-scheme:dark){:root{--theme:#1d1e20;--entry:#2e2e33;--primary:rgba(255, 255, 255, 0.84);--secondary:rgba(255, 255, 255, 0.56);--tertiary:rgba(255, 255, 255, 0.16);--content:rgba(255, 255, 255, 0.74);--hljs-bg:#2e2e33;--code-bg:#37383e;--border:#333}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style>
</noscript>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(a,e,f,g,b,c,d){a.GoogleAnalyticsObject=b,a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},a[b].l=1*new Date,c=e.createElement(f),d=e.getElementsByTagName(f)[0],c.async=1,c.src=g,d.parentNode.insertBefore(c,d)}(window,document,'script','https://www.google-analytics.com/analytics.js','ga'),ga('create','UA-123-45','auto'),ga('send','pageview'))</script><meta property="og:title" content="yuler's blog">
<meta property="og:description" content="yuler's blog">
<meta property="og:type" content="website">
<meta property="og:url" content="https://zhangyh.me/"><meta property="og:image" content="https://zhangyh.me/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="og:site_name" content="yuler's blog">
<meta name=twitter:card content="summary_large_image">
<meta name=twitter:image content="https://zhangyh.me/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E">
<meta name=twitter:title content="yuler's blog">
<meta name=twitter:description content="yuler's blog">
<script type=application/ld+json>{"@context":"https://schema.org","@type":"Organization","name":"yuler's blog","url":"https://zhangyh.me/","description":"yuler\u0026#39;s blog","thumbnailUrl":"https://zhangyh.me/icon/jiaran16.ico","sameAs":["mailto:zyh.me@outlook.com","https://github.com/yu1er"]}</script>
</head>
<body class=list id=top>
<script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add('dark'):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove('dark'):window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add('dark')</script>
<header class=header>
<nav class=nav>
<div class=logo>
<a href=https://zhangyh.me/ accesskey=h title="Home (Alt + H)">Home</a>
<span class=logo-switches>
<button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
</button>
</span>
</div>
<ul id=menu>
<li>
<a href=https://zhangyh.me/archives/ title=archives>
<span>archives</span>
</a>
</li>
<li>
<a href=https://zhangyh.me/categories/ title=categories>
<span>categories</span>
</a>
</li>
<li>
<a href=https://zhangyh.me/tags/ title=tags>
<span>tags</span>
</a>
</li>
<li>
<a href=https://zhangyh.me/search/ title="search (Alt + /)" accesskey=/>
<span>search</span>
</a>
</li>
</ul>
</nav>
</header>
<main class=main>
<article class="first-entry home-info">
<header class=entry-header>
<h1>Hi there ğŸŒˆ</h1>
</header>
<section class=entry-content>
<p></p>
</section>
<footer class=entry-footer>
<div class=social-icons>
<a href=mailto:zyh.me@outlook.com target=_blank rel="noopener noreferrer me" title=Email><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 21" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1.0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1.0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg>
</a>
<a href=https://github.com/yu1er target=_blank rel="noopener noreferrer me" title=Github><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg>
</a>
</div>
</footer>
</article>
<article class=post-entry>
<header class=entry-header>
<h2>SFM: Mitigating Read/Write Amplification Problem of LSM-Tree-Based Key-Value Stores
</h2>
</header>
<section class=entry-content>
<p>Movitation ä¼ ç»Ÿçš„merge policy Level Merge Policyå’ŒTiered Merge Policyåœ¨è¯»å†™æ”¾å¤§æ–¹é¢å„æœ‰ä¼˜åŠ¿. å‰è€…ç›¸å½“äºå•å±‚çš„Tiered,ä¿è¯äº†å•å±‚æ•°æ®çš„æœ‰åºæ€§,å‡å°‘äº†è¯»æ”¾å¤§,ä½†è¦ç»´æŠ¤è¿™ç§æœ‰åºæ€§,å°±éœ€è¦é¢‘ç¹çš„merge,å› æ­¤é€ æˆäº†ä¸¥é‡çš„å†™æ”¾å¤§. åè€…å¯¹æœ‰åºæ€§çš„è¦æ±‚å¹¶ä¸ä¸¥æ ¼,å®ƒåªè¦æ±‚æ¯ä¸ªgroupçš„key rangeäº’ä¸äº¤å‰,å…è®¸sstableä¹‹é—´çš„keyäº¤å‰.
å·¥ä½œè´Ÿè½½çš„ç©ºé—´å±€éƒ¨æ€§ ä½œè€…å¯¹ZippyDB(facebook)çš„å·¥ä½œè´Ÿè½½åˆ†æå‘ç°,å°‘éƒ¨åˆ†çš„keyè¢«è¯»å†™å¤šæ¬¡,å¤§éƒ¨åˆ†çš„keyè¢«è¯»å†™çš„æ¬¡æ•°å¾ˆå°‘.
Design ä½œè€…æå‡ºäº†ç–‘é—®:
How to resolve the read amplification problem induced by the tiering merge policy while maintaining its low write amplification?
æ ¹æ®key-spaceçš„ä¸åŒaccess pattern,æœ‰é€‰æ‹©çš„é‡‡ç”¨Tieringå’ŒLeveling Merge policy. é€šè¿‡è¿½è¸ªæ¯å±‚ä¸­çš„key-spaceçš„è®¿é—®å¼ºåº¦,æ¥å†³å®šè®¾ç½®Tçš„å€¼ä¸º1è¿˜æ˜¯configured threshold.
Spatially Fragmented LSM-TREE (SFM) æ¯å±‚é€šè¿‡éšæœºçš„è¾¹ç•Œåˆ†ä¸ºä¸åŒçš„key-space.è¾¹ç•Œçš„é€‰å–æ–¹å¼ç±»ä¼¼äºPebblesDB. å¦‚æœä¸€ä¸ªæ ˆçš„key-rangeè¢«è®¤ä¸ºæ˜¯è¯»å¯†é›†çš„,åˆ™è®¾ç½®Tä¸º1,å¦åˆ™,æŒ‰ç…§åŸæœ‰çš„é…ç½®è®¾ç½®.
åˆå¹¶ç­–ç•¥å¦‚ä¸Šå›¾
è¯»è¶…è¿‡stacké˜ˆå€¼çš„æ–‡ä»¶åˆ°å†…å­˜ åœ¨å†…å­˜ä¸­è¿›è¡Œmerge æŒ‰ç…§ä¸‹å±‚çš„keyè¾¹ç•Œè¿›è¡Œåˆ‡ç‰‡ æ–°SSTableè¢«åˆ·æ–°åˆ°ä¸‹å±‚ æ·»åŠ åˆ°keyå¯¹åº”çš„æ ˆ B. Read Intensity Identification å¦‚ä½•åˆ¤æ–­è¯»çš„å¼ºåº¦å‘¢? ç»Ÿè®¡æ¯ä¸ªæ®µçš„è¯»å†™æ¬¡æ•°.å¯¹äºè¯»æ“ä½œ,å³ä½¿è¯»å–çš„keyä¸å­˜åœ¨,ä¹Ÿæ˜¯è¦è®¡å…¥è¯»å–æ¬¡æ•°çš„. å¯¹äºå†™æ“ä½œ,ç»Ÿè®¡æ¯æ¬¡mergeåçš„sstableä¸­çš„kvå¯¹çš„æ•°é‡. é€šè¿‡å¯¹æ¯”æ¯ä¸ªstackçš„r/wå’Œæ•´ä½“å¹³å‡çš„r/wæ¥åˆ¤æ–­å…¶ä¸ºhotè¿˜æ˜¯cold. æ ¹æ®æ¯ä¸ªstackçš„hotè¿˜æ˜¯coldå±æ€§,æ¥å†³å®škey-spaceçš„è®¿é—®å¼ºåº¦.
Metadata Managment é€šè¿‡StackMetadataçš„æ•°æ®ç»“æ„æ¥ç®¡ç†æ¯ä¸ªstackçš„å…ƒä¿¡æ¯....</p>
</section>
<footer class=entry-footer>9-24&nbsp;Â·&nbsp;yuler</footer>
<a class=entry-link aria-label="post link to SFM: Mitigating Read/Write Amplification Problem of LSM-Tree-Based Key-Value Stores" href=https://zhangyh.me/posts/paper/sep/sfm/></a>
</article>
<article class=post-entry>
<header class=entry-header>
<h2>weekly-contest-259
</h2>
</header>
<section class=entry-content>
<p>ç¬¬259æ¬¡å‘¨èµ› A. æ‰§è¡Œæ“ä½œåçš„å˜é‡å€¼ æ—¶é—´å¤æ‚åº¦: $O(n)$ ç©ºé—´å¤æ‚åº¦: $O(1)$ class Solution { public: int finalValueAfterOperations(vector&lt;string>& operations) { int X = 0; for (auto & s: operations) { if (s[1] == '+') X++; else X--; } return X; } }; B. æ•°ç»„ç¾ä¸½å€¼æ±‚å’Œ é€šè¿‡æ­£åä¸¤æ¬¡éå†è®°å½•æ¯ä¸ªå€¼å·¦è¾¹çš„æœ€å¤§å€¼å’Œå³è¾¹çš„æœ€å°å€¼.
æ—¶é—´å¤æ‚åº¦: $O(n)$ ç©ºé—´å¤æ‚åº¦: $O(n)$ class Solution { public: int sumOfBeauties(vector&lt;int>& nums) { int n = nums.size(); vector&lt;int> left(n, INT_MIN), right(n, INT_MAX); int ans = 0; left[0] = nums[0]; right[n - 1] = nums[n - 1]; for (int i = 1; i &lt; n; i++) left[i] = max(left[i-1], nums[i]); for (int i = n - 2; i >= 0; i--) right[i] = min(right[i + 1], nums[i]); for (int i = 1; i &lt; n - 1; i++) { if (left[i - 1] &lt; nums[i] && nums[i] &lt; right[i + 1]) ans +=2; else if (nums[i - 1] &lt; nums[i] && nums[i] &lt; nums[i + 1]) ans++; } return ans; } }; C....</p>
</section>
<footer class=entry-footer>9-20&nbsp;Â·&nbsp;yuler</footer>
<a class=entry-link aria-label="post link to weekly-contest-259" href=https://zhangyh.me/posts/leetcode/weekly-contest-259/></a>
</article>
<article class=post-entry>
<header class=entry-header>
<h2>biweekly-contest-61
</h2>
</header>
<section class=entry-content>
<p>ç¬¬61æ¬¡åŒå‘¨èµ› A: å·®çš„ç»å¯¹å€¼ä¸º K çš„æ•°å¯¹æ•°ç›® æ—¶é—´å¤æ‚åº¦:$O(n)$ ç©ºé—´å¤æ‚åº¦:$O(n)$ class Solution { public: int countKDifference(vector&lt;int>& nums, int k) { map&lt;int, int> m; int ans; for (auto && x : nums) { ans += (m[x + k] + m[x - k]); m[x]++; } return ans; } }; B: ä»åŒå€æ•°ç»„ä¸­è¿˜åŸåŸæ•°ç»„ ä¸¤ä¸ªå…³é”®ç‚¹: 1. å…ƒç´ ä¸ªæ•°ä¸€å®šä¸ºå¶æ•° 2. ç»“æœæ•°ç»„å…ƒç´ ä¸ªæ•°ä¸€å®šæ˜¯åŸæ•°ç»„äºŒåˆ†ä¹‹ä¸€
æ—¶é—´å¤æ‚åº¦: æ’åº: $O(nlgn)$ éå†: $O(n)$ ç©ºé—´å¤æ‚åº¦: $O(n)$ class Solution { public: vector&lt;int> findOriginalArray(vector&lt;int>& changed) { auto n = changed....</p>
</section>
<footer class=entry-footer>9-19&nbsp;Â·&nbsp;yuler</footer>
<a class=entry-link aria-label="post link to biweekly-contest-61" href=https://zhangyh.me/posts/leetcode/biweekly-contest-61/></a>
</article>
<article class=post-entry>
<header class=entry-header>
<h2>èŠèŠå†…å­˜å¯¹é½
</h2>
</header>
<section class=entry-content>
<p>ä¸ºä»€ä¹ˆéœ€è¦å†…å­˜å¯¹é½ï¼Ÿ é¦–å…ˆéœ€è¦ä»ç‰©ç†ç¡¬ä»¶ä¸Šäº†è§£è®¡ç®—æœºå¦‚ä½•è¿›è¡Œå†…å­˜è®¿é—®çš„ã€‚
Channel > DIMM > Rank > Chip > Bank > Coloum/Row > Cell
å¦‚ä¸Šå›¾ CPUåŒ…æ‹¬ä¸¤ä¸ªChannel æ¯ä¸ªChannelåŒ…æ‹¬ä¸¤ä¸ªDIMM æ¯ä¸ªDIMMç”±Rankç»„æˆ Rankç”±8ä¸ªå†…å­˜é¢—ç²’chipç»„æˆ æ¯ä¸ªChipåŒ…æ‹¬8ä¸ªBank
CPUè¯»å–å†…å­˜æ—¶ä»8ä¸ªchipä¸­æ¯ä¸ªè¯»å–8bitå­—èŠ‚ï¼Œä»è€Œæ„æˆ64bit columnå’Œrowå®šä½çš„ä¸€ä¸ªå•å…ƒæ ¼cellä¸­æœ‰8ä¸ªbit
å› æ­¤ä¸€æ¬¡æ€§æœ€å°‘è¯»å–64bitï¼Œè¿™æ°å¥½ä¹Ÿæ˜¯cachelineçš„å¤§å°ã€‚ ï¼ˆcachelineæ˜¯cacheçš„åŸºæœ¬å•ä½ï¼Œæ¯ä¸ªcacheç”±è‹¥å¹²cachelineç»„æˆï¼‰
ä»€ä¹ˆæ˜¯å†…å­˜å¯¹é½ ä»ä¸Šé¢æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œä¸€æ¬¡æ€§æœ€å°‘è¯»å–8Bï¼Œè¿™ä¹Ÿæ˜¯å±€éƒ¨æ€§åŸç†çš„ä¸€ç§ä½¿ç”¨ã€‚
å†…å­˜å¯¹é½å°±æ˜¯ä»£ç ç¼–è¯‘ååœ¨å†…å­˜ä¸­çš„å¸ƒå±€ï¼Œå½“ä¸€ä¸ªå†…å­˜åœ°å€åˆšå¥½èƒ½å¤Ÿæ•´é™¤8ï¼Œå°±ç§°ä¸ºå…¶å†…å­˜åœ°å€æ˜¯8å­—èŠ‚å¯¹é½çš„ã€‚
ä¸ºä»€ä¹ˆéœ€è¦å†…å­˜å¯¹é½ å¯¹äºgoä¸­å®šä¹‰çš„å¦‚ä¸‹ç»“æ„
type Type1 struct { a int8 b int64 c int32 } å…¶å†…å­˜å¸ƒå±€æ˜¯è¿™æ ·çš„ï¼š é€šè¿‡unsafe.Sizeof()å¯ä»¥æ‰“å°å‡ºè¯¥ç»“æ„å ç”¨äº†24å­—èŠ‚çš„å†…å­˜ã€‚
å¦‚æœè°ƒæ•´ä¸€ä¸‹é¡ºåºï¼š
type Type2 struct { a int8 c int32 b int64 } ä¾¿å¯ä»¥èŠ‚çº¦ä¸€ä¸ªå­—èŠ‚çš„å†…å­˜
é›¶å¤§å°å­—æ®µ å¦‚æœç»“æ„ä½“æˆ–æ•°ç»„ç±»å‹ä¸åŒ…å«å¤§å°å¤§äºé›¶çš„å­—æ®µæˆ–å…ƒç´ ï¼Œé‚£ä¹ˆå®ƒçš„å¤§å°å°±ä¸º0
package main import ( "fmt" "unsafe" ) type M struct { m int64 x struct{} } type N struct { x struct{} n int64 } func main() { m, n := M{}, N{} fmt....</p>
</section>
<footer class=entry-footer>8-13&nbsp;Â·&nbsp;yuler</footer>
<a class=entry-link aria-label="post link to èŠèŠå†…å­˜å¯¹é½" href=https://zhangyh.me/posts/misc/%E5%86%85%E5%AD%98%E5%AF%B9%E9%BD%90/></a>
</article>
<article class=post-entry>
<header class=entry-header>
<h2>LSM-based storage techniques: a survey
</h2>
</header>
<section class=entry-content>
<p> paperåŸæ–‡ï¼šLSM-based storage techniques: a survey
LSM-tree basics å¯¹äºç´¢å¼•ç»“æ„é€šå¸¸æœ‰ä¸¤ç§æ›´æ–°ç­–ç•¥ï¼Œå³in-place updateå’Œout-of-place updateã€‚
in-placeé€šå¸¸ä½¿ç”¨B+æ ‘ä½œä¸ºåº•å±‚æ•°æ®ç»“æ„ï¼Œé€šè¿‡éšæœºå†™æ¥æ›´æ–°æ•°æ®é¡¹ï¼Œå¸¦æ¥çš„æ˜¯è¯»æ•°æ®çš„ä¼˜åŒ–ï¼ŒåŒæ—¶æ¯ä¸ªæ•°æ®é¡¹åªå­˜æœ‰ä¸€ä»½ï¼Œå› æ­¤èŠ‚çº¦äº†ç©ºé—´ã€‚
out-placeé€šå¸¸ä½¿ç”¨lsm treeä½œä¸ºåº•å±‚æ•°æ®ç»“æ„ï¼Œå°†éšæœºå†™è½¬åŒ–ä¸ºé¡ºåºå†™ï¼ŒåŠ å¿«äº†å†™çš„é€Ÿåº¦ï¼Œä½†åŒæ—¶é™ä½äº†è¯»æ•°æ®çš„æ€§èƒ½ï¼Œå¦å¤–ï¼Œå¯¹åŒä¸€ä¸ªkeyï¼Œå­˜æœ‰å¤šä¸ªç‰ˆæœ¬ï¼Œå¸¦æ¥äº†ç©ºé—´ä¸Šçš„æµªè´¹ã€‚
LevelDBæ˜¯è°·æ­Œå¼€æºçš„kvæ•°æ®åº“ï¼Œå®ƒåŸºäºå†…å­˜-ç£ç›˜çš„å­˜å‚¨å±‚æ¬¡ï¼Œå®ç°äº†LSM Treeæœ€åŸºæœ¬çš„åŠŸèƒ½ã€‚ å†…å­˜ä¸­æœ‰memtableï¼Œä½¿ç”¨skiplistæ¥æŒ‰é¡ºåºå­˜å‚¨kvå¯¹ ç£ç›˜ä¸­æœ‰åˆ†å±‚çš„sstableï¼Œä½¿ç”¨sorted-string tableä»¥æ–‡ä»¶çš„å½¢å¼æ¥å­˜å‚¨ã€‚ sstableåŒ…æ‹¬äº†data blockã€index blockã€footer block
å¦‚ä»Šçš„lsm treeé€šå¸¸ä¸ºäº†åŠ å¿«è¯»é€Ÿåº¦ï¼Œå¾€å¾€ä¼šå…·æœ‰bloom filterç»„ä»¶ï¼Œè¯¥ç»„ä»¶æœ‰ä¸¤ä¸ªæ“ä½œï¼šæ’å…¥keyå’Œæ£€æŸ¥keyæ˜¯å¦å­˜åœ¨ã€‚ä¸ºç£ç›˜ä¸­çš„æ¯ä¸€levelï¼Œç»´æŠ¤ä¸€ä¸ªbloom filterï¼Œä»è€Œæé«˜è¯»æ€§èƒ½ã€‚éœ€è¦æ³¨æ„ï¼Œå®ƒæ˜¯false positiveçš„ã€‚ åŒæ—¶å› ä¸ºè¯¥ç»“æ„æ¯”è¾ƒå°ï¼Œå¾€å¾€æŠŠä»–ç¼“å­˜åˆ°å†…å­˜å½“ä¸­ã€‚
å¯¹äºfailure recoveryï¼Œä½¿ç”¨WALä¿è¯å†…å­˜ä¸­memtableçš„recoveryï¼Œä½¿ç”¨manifestä¿è¯mergeè¿‡ç¨‹ä¸­sstableçš„recoveryã€‚
æœ‰ä¸¤ç§å¸¸ç”¨çš„merge policyï¼Œå¦‚ä¸Šå›¾æ‰€ç¤ºã€‚ Leveling merge policyï¼Œè¦æ±‚æ¯ä¸€å±‚çš„SSTableä¹‹é—´ä¸èƒ½overlapï¼Œmergeçš„æ—¶å€™å°†ç¬¬iå±‚çš„SSTableå’Œç¬¬i+1å±‚overlapeçš„æ‰€æœ‰SSTablesè¿›è¡Œmergeï¼Œç„¶åå†™å…¥i+1å±‚ã€‚ä¹Ÿå°±æ˜¯è¯´é€šè¿‡levelingé€šè¿‡é¢‘ç¹çš„mergeï¼Œä½¿å¾—æ¯ä¸€å±‚å…¨éƒ¨æœ‰åºï¼Œç‰ºç‰²éƒ¨åˆ†å†™æ€§èƒ½æ¥æ¢å–è¯»æ€§èƒ½ã€‚
Tiering merge policyï¼Œè¦æ±‚æ¯ä¸€å±‚çš„SSTableä¹‹é—´å¯ä»¥overlapï¼Œåœ¨sstableè¾¾åˆ°ä¸€å®šçš„æ•°é‡æˆ–è€…sizeè¦æ±‚åï¼Œå¯¹è¯¥å±‚æ‰€æœ‰çš„SSTableè¿›è¡Œmerge sortï¼Œç„¶åç›´æ¥flushè¿›ä¸‹ä¸€å±‚ã€‚è¯¥ç­–ç•¥é€šè¿‡å‡å°‘mergeæ“ä½œï¼Œç‰ºç‰²éƒ¨åˆ†è¯»æ€§èƒ½æ¢å–äº†å†™æ€§èƒ½ã€‚
LSM-tree improvement æ–‡ç« å°†å¯¹LSM-treeçš„ä¼˜åŒ–åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š
Write Amplification: out-of-placeæ•°æ®ç»“æ„æ‰€å…·æœ‰çš„é—®é¢˜ï¼Œé™ä½äº†å†™æ€§èƒ½å’Œç£ç›˜å¯¿å‘½ã€‚ Merge Operation: mergeåä¼šé€ æˆbuffer cache missï¼Œå¤§æ•°æ®é‡çš„mergeä¼šé€ æˆwrite stall Hardware: é’ˆå¯¹large memory,multi-core, SSD/NVM, native storageçš„ä¼˜åŒ– Special Workloads: Auto-tuning: ä¸å¯èƒ½åŒæ—¶è¾¾åˆ°read,write,spaceåŒæ—¶æœ€ä¼˜ï¼Œå¹¶ä¸”ç”±äºlsm treeæ‹¥æœ‰å¤§é‡å‚æ•°ï¼Œæ‰‹åŠ¨è°ƒä¼˜ä¹Ÿæ˜¯å›°éš¾çš„ã€‚ Secondary Indexing: lsm treeåªæ”¯æŒç®€å•çš„kvæ¥å£ï¼ŒäºŒçº§ç´¢å¼•ä¹Ÿæ˜¯ä¸€ä¸ªæ–¹å‘ã€‚ </p>
</section>
<footer class=entry-footer>8-10&nbsp;Â·&nbsp;yuler</footer>
<a class=entry-link aria-label="post link to LSM-based storage techniques: a survey" href=https://zhangyh.me/posts/paper/aug/suvery-of-lsm/></a>
</article>
<article class=post-entry>
<header class=entry-header>
<h2>Wisckey: Separating keys from values in ssd-conscious storage
</h2>
</header>
<section class=entry-content>
<p>WiscKey Design Goals Lowå†™æ”¾å¤§ Lowè¯»æ”¾å¤§ SSDä¼˜åŒ– Feature-rich API (scanã€snapshot) Realistic k-v size (valueçš„sizeé€šå¸¸æ¯”keyçš„å¤§å¾ˆå¤š) K-V Separation LSM treeçš„ä¸»è¦æ€§èƒ½æˆæœ¬åœ¨äºCompactionï¼Œä½†å®ƒç»´æŠ¤äº†keyçš„æœ‰åºæ€§ï¼Œå¯¹äºåŠ é€Ÿè¯»ä¹Ÿæ˜¯ååˆ†æœ‰å¿…è¦çš„ã€‚ Compactionåªéœ€è¦å¯¹keyæ’åºï¼Œå› æ­¤è€ƒè™‘å°†k-våˆ†å¼€å­˜å‚¨ã€‚åªæŠŠvalueçš„åœ°å€å’Œkeyæ”¾åœ¨ä¸€èµ·ã€‚ LSM treeçš„sizeå°†å¤§å¤§å˜å°ï¼Œå‡å°‘äº†å†™æ”¾å¤§ã€‚ è¯»æ“ä½œè™½ç„¶éœ€è¦ä¸€æ¬¡é¢å¤–çš„å¯»å€æ“ä½œï¼Œä½†æ›´å°çš„LSM treeåŠ å¿«äº†æ£€ç´¢åŒæ—¶æ›´å®¹æ˜“ç¼“å­˜åˆ°å¤§å†…å­˜ä¸­ã€‚ Challenge Parallel Range Query åœ¨levelDBä¸­ï¼ŒèŒƒå›´æŸ¥è¯¢é€šè¿‡iteratorçš„é¡ºåºè¯»å®ç°ï¼Œä½†æ˜¯ç°åœ¨ç”±äºå’Œkeyä¸€åŒå­˜å‚¨çš„åªæœ‰valueçš„åœ°å€ï¼ŒèŒƒå›´æŸ¥è¯¢å˜ä¸ºäº†éšæœºioã€‚ æˆ‘ä»¬åœ¨è¯»å–æ‰€æœ‰çš„åœ°å€åï¼Œå†™å…¥ä¸€ä¸ªé˜Ÿåˆ—ï¼Œé€šè¿‡å¤šçº¿ç¨‹å¹¶å‘è¯»å–ï¼Œæ¥åŠ å¿«èŒƒå›´æŸ¥è¯¢çš„æ€§èƒ½ã€‚
Garbage Collection ç”±äºæŠŠæ‰€æœ‰çš„æ•°æ®éƒ½å­˜åˆ°äº†vLogé‡Œï¼Œæœ€æœ´ç´ çš„åƒåœ¾å›æ”¶çš„æ–¹æ³•å½“ç„¶æ˜¯æ‰«æä¸€éLSM-treeï¼Œä½†å¼€é”€å¤ªå¤§äº†ï¼Œåªé€‚ç”¨äºç¦»çº¿ç¯å¢ƒã€‚ WiscKeyåœ¨vlogä¸­å­˜å‚¨(ksize, vsize, key, value)ï¼Œå¹¶ç»´æŠ¤headå’ŒtailæŒ‡é’ˆã€‚ æ•°æ®åœ¨headå¤„æ·»åŠ  åƒåœ¾å›æ”¶çº¿ç¨‹ä»tailå¤„æ‰«æï¼Œæ¯æ¬¡æ‰«æä¸€å®šé‡çš„æ•°æ®ï¼ˆå‡ MBï¼‰ï¼Œç„¶ååœ¨LSM-treeä¸­æŸ¥æ‰¾ï¼Œå¦‚æœkvå¯¹æœ‰æ•ˆçš„è¯ï¼Œåˆ™å†æŠŠå®ƒæ·»åŠ åˆ°headå¤„ã€‚ å› æ­¤ï¼Œåªæœ‰tailå’Œheadä¹‹é—´çš„æ•°æ®æ˜¯æœ‰æ•ˆçš„ã€‚
Crash Consistency Optimizations Value-Log Write Buffer å¯¹äºå†™å¯†é›†çš„æ•°æ®é›†ï¼Œé¢‘ç¹çš„å¤§é‡çš„å°sizeçš„valueå†™å…¥ï¼Œä¼šå¯¼è‡´è¾ƒå¤§çš„ç³»ç»Ÿå¼€é”€ã€‚ å› æ­¤è€ƒè™‘åœ¨å†…å­˜ä¸­ç»´æŠ¤Bufferã€‚ å½“è¯»æ•°æ®çš„æ—¶å€™ï¼Œå…ˆåˆ°vlog write bufferä¸­æŸ¥æ‰¾ï¼Œå¦‚æœæ²¡æœ‰ï¼Œå†æŸ¥vlogã€‚ crash-consistencyçš„ç»´æŠ¤ç±»ä¼¼äºlevelDBï¼Œä½¿ç”¨WALã€‚
Optimizing the LSM-tree Log åœ¨å†™LSM-treeä¹‹å‰éœ€è¦å…ˆå†™vlogï¼Œå› ä¸ºè¿™é‡Œæˆ‘ä»¬åŠ äº†vlog write bufferï¼Œæ‰€ä»¥æˆ‘ä»¬ç›´æ¥ç”¨vlogçš„æ—¥å¿—ä½œä¸ºWALã€‚</p>
</section>
<footer class=entry-footer>8-10&nbsp;Â·&nbsp;yuler</footer>
<a class=entry-link aria-label="post link to Wisckey: Separating keys from values in ssd-conscious storage" href=https://zhangyh.me/posts/paper/aug/wisckey/></a>
</article>
<article class=post-entry>
<header class=entry-header>
<h2>Hashkv: Enabling efficient updates in KV storage via hashing
</h2>
</header>
<section class=entry-content>
<p>Hashkv: Enabling efficient updates in KV storage via hashing Introduction kvåˆ†ç¦»çš„Wisckeyåœ¨vLogçš„GCä¸Šæœ‰ç€ä»¥ä¸‹çš„é—®é¢˜ï¼š
æœ€æ–°å†™å…¥çš„æ•°æ®è¢«ä»tailè¿ç§»åˆ°headå¤„ï¼Œå¸¦æ¥äº†å†™æ”¾å¤§ã€‚ æ¯æ¬¡GCï¼Œå¯¹äºæ¯ä¸€é¡¹éƒ½éœ€è¦å»æŸ¥è¯¢LSM-Treeï¼Œå»éªŒè¯æ˜¯å¦è¿˜æœ‰æ•ˆï¼Œé€ æˆå¤§é‡éšæœºè¯» Design Storage Management å›ºå®šå¤§å°çš„ç©ºé—´å•å…ƒmain segmentå’Œlog segmentã€‚ é»˜è®¤åˆ†åˆ«ä¸º64MBå’Œ1MB.
segment group åŒ…æ‹¬ä¸€ä¸ªmain segmentå’Œå¤šä¸ªlog segment.
å†…å­˜ä¸­å…¨å±€çš„segment tableå­˜å‚¨æ¯ä¸€ä¸ªsegment groupæ¥ä¸‹æ¥æ’å…¥æˆ–æ›´æ–°çš„ä½ç½®ã€‚
ä¸ºäº†æ–¹ä¾¿GCï¼Œsegment groupå­˜å‚¨äº†key/value sizeï¼Œkeyï¼Œvalue
GC Collection GCä»¥segment groupä¸ºå•å…ƒï¼Œå½“free log segmentç”¨å°½çš„æ—¶å€™ä¼šè§¦å‘ã€‚
é¦–å…ˆé€‰æ‹©å€™é€‰çš„segment groupï¼Œå¹¶è¯†åˆ«valid KV ç„¶åå°†valid KVå†™æ–°çš„main segmentå’Œlog segment å†é‡Šæ”¾ä¹‹å‰æœªä½¿ç”¨çš„log segment æœ€åæ›´æ–°LSM-Treeä¸­valueçš„æœ€æ–°ä½ç½® ä¸¤ä¸ªé—®é¢˜ï¼š
å¦‚ä½•é€‰æ‹©å€™é€‰çš„segment group? æ ¹æ®æ›´æ–°çš„kvæ•°é‡ï¼Œå¿«é€Ÿé€‰æ‹© å¦‚ä½•å¿«é€ŸéªŒè¯KVæ—¶validçš„ ä»å°¾éƒ¨ç¬¬ä¸€æ¬¡è¯»åˆ°çš„keyï¼Œå®ƒå¯¹åº”çš„kvä¸€å®šæ˜¯æœ€æ–°çš„ã€‚ Hotness Awareness åœ¨å¯¹segment groupè¿›è¡ŒGCåï¼Œå†³å®šå…¶ä¸­æ•°æ®é¡¹ä¸ºhotè¿˜æ˜¯codeã€‚
hotæ•°æ®ä»ç„¶å†™å›segment group. codeæ•°æ®å†™åˆ°å¦å¤–ä¸€ä¸ªåŒºåŸŸï¼Œæ—¨åœ¨segment groupä¸­ä¿ç•™å…¶metadata()
å¦‚ä½•åˆ¤æ–­å†·çƒ­ï¼Ÿ åœ¨æœ€åæ’å…¥åï¼Œåˆæ›´æ–°è¿‡ä¸€æ¬¡çš„å³ä¸ºçƒ­æ•°æ®ã€‚
æˆ‘ä»¬ç§°å‘¼è¯¥è¿‡ç¨‹ä¸ºtaggingï¼Œæ³¨æ„ï¼Œtaggingåªå‘ç”Ÿåœ¨GCæ—¶ã€‚...</p>
</section>
<footer class=entry-footer>8-7&nbsp;Â·&nbsp;yuler</footer>
<a class=entry-link aria-label="post link to Hashkv: Enabling efficient updates in KV storage via hashing" href=https://zhangyh.me/topics/paper/hashkv.html></a>
</article>
<article class=post-entry>
<header class=entry-header>
<h2>A Light-weight Compaction Tree to Reduce I/O Amplification toward Efficient Key-Value Stores
</h2>
</header>
<section class=entry-content>
<p>A Light-weight Compaction Tree to Reduce I/O Amplification toward Efficient Key-Value Stores Introduction ä¸€èˆ¬æƒ…å†µä¸‹çš„LSM Treeå†™æ”¾å¤§èƒ½è¾¾åˆ°50Xå€ ç¼“è§£å†™æ”¾å¤§çš„æ–¹æ³•å¯èƒ½æœ‰ä»¥ä¸‹å‡ ç§ï¼š
ä½¿ç”¨æ›´å¤§çš„å†…å­˜buffer åˆ©ç”¨è®¾å¤‡çš„ç‰¹æ€§ é€æ­¥æ•£åˆ— KV é¡¹ å‡å°‘levelå±‚çº§ å‡å°‘æ¯å±‚çš„ç©ºé—´æ”¾å¤§å› å­ Design light-weight compaction ä¹Ÿæ˜¯å€Ÿé‰´äº†wisckeyä¸­æåˆ°çš„ï¼Œmerge and sortè¿‡ç¨‹åªæ˜¯é¢å‘keyçš„ï¼Œä¸éœ€è¦valueçš„å‚ä¸ åœ¨å¯¹Level i å’Œ Level i+1è¿›è¡Œcompactionæ—¶ï¼Œæˆ‘ä»¬æŠŠç¬¬iå±‚çš„å€™é€‰çš„sstableæˆä¸ºvictimï¼ŒæŠŠä¸victimæœ‰overlapçš„i+1å±‚çš„sstableæˆä¸ºoverlaped. (æ³¨æ„è¯¥è®ºæ–‡ä¸ºsstableè®¾è®¡äº†å¦å¤–ä¸€ç§å­˜å‚¨æ ¼å¼ï¼Œæˆä¸ºDTable) å› æ­¤æ•´ä¸ªlightweight compactionè¿‡ç¨‹ä¸º:
è¯»å–victimåˆ°å†…å­˜ä¸­ï¼ŒvictimåŒ…æ‹¬äº†overlapedçš„metadata ç„¶åæ ¹æ®metadataï¼Œå°†victimåˆ†ä¸ºå‡ ä¸ªsegment å†æ ¹æ®key rangeå°†segmentè¿½åŠ åˆ°å¯¹åº”çš„DTableä¸­ victimä¸€å±‚çš„å†™æ”¾å¤§è¢«æ¶ˆé™¤äº†ï¼Œéšä¹‹å¸¦æ¥çš„é—®é¢˜å°±æ˜¯DTableçš„è¯»ï¼Œè™½ç„¶æ¯ä¸€å±‚çš„DTableä¹‹é—´æ˜¯æ— overlapä¸”æœ‰åºçš„ï¼Œä½†æ˜¯DTableå†…çš„keyå€¼å¹¶ä¸æ˜¯å®Œå…¨æœ‰åºçš„ã€‚
é™ä½äº†å¤§æ¦‚10Xçš„å†™æ”¾å¤§.
Metadata Aggregation overlapedçš„å…ƒæ•°æ®å¦‚ä½•è·å–ã€‚ ç›´è§‰çš„æ–¹æ³•æ˜¯ç›´æ¥ä»overlapedè¯»ï¼Œä½†è¿™å¸¦æ¥çš„éšæœºioè¿èƒŒäº†æˆ‘ä»¬çš„è®¾è®¡åˆè¡·ã€‚ å¦ä¸€ç§æ˜¯ç›´æ¥åœ¨å†…å­˜ä¸­ç¼“å­˜å…ƒæ•°æ®ï¼Œä½†è¿™éƒ¨åˆ†å¼€é”€å¹¶ä¸ç®—å°ï¼Œå¹¶ä¸åˆ’ç®— ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬æå‡ºäº†å…ƒæ•°æ®èšåˆã€‚ åœ¨ä¸€æ¬¡compactionå®Œæˆåï¼Œç¬¬i+1å±‚è¢«æ›´æ–°çš„å…ƒæ•°æ®å­˜å‚¨åˆ°victimä¸­ï¼Œä»¥æ­¤é¿å…ä¸‹ä¸€æ¬¡compactionæ—¶å¯¹metadataçš„è®¿é—®å‘¢ã€‚
é€šè¿‡compactionè¿‡ç¨‹ä¸­ä¸€æ¬¡é¢å¤–çš„å†™ï¼Œå‡å°‘AFå€çš„i+1å±‚çš„éšæœºè¯»ã€‚
Data structure of DTable æ¯ä¸ªDTableç»´æŠ¤ä¸‹å±‚çš„overlaped Dtables metadata æ¯æ¬¡compactionè¿‡ç¨‹ä¸­appendè¿›æ¥çš„æ•°æ®ä½œä¸ºä¸€ä¸ªsegment,segmentä¹‹é—´çš„keyæ˜¯overlapçš„,ä¼šå¯¼è‡´æŸ¥æ‰¾æ€§èƒ½çš„ä¸‹é™ MetadaBlockåŒ…æ‹¬äº†bloom filter blocks,overlaped metada_index block, metada_index block,index block footer...</p>
</section>
<footer class=entry-footer>8-6&nbsp;Â·&nbsp;yuler</footer>
<a class=entry-link aria-label="post link to A Light-weight Compaction Tree to Reduce I/O Amplification toward Efficient Key-Value Stores" href=https://zhangyh.me/posts/paper/aug/lwc-tree/></a>
</article>
<footer class=page-footer>
<nav class=pagination>
<a class=next href=https://zhangyh.me/page/2/>Next Page Â»</a>
</nav>
</footer>
</main>
<footer class=footer>
<span>&copy; 2021 <a href=https://zhangyh.me/>yuler's blog</a></span>
<span>
Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a>
</span>
</footer>
<a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a>
<script>let menu=document.getElementById('menu');menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)},document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script>
<script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script>
<script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script>
</body>
</html>